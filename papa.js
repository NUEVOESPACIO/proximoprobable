/**
 * Bundled by jsDelivr using Rollup v2.79.1 and Terser v5.19.2.
 * Original file: /npm/read-excel-file@5.7.0/index.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import{unzipSync as r,strFromU8 as t}from"/npm/fflate@0.7.4/+esm";var e={createDocument:function(r){return(new DOMParser).parseFromString(r.trim(),"text/xml")}};function n(e){var n=new Uint8Array(e),o=r(n);return Promise.resolve(function(r){for(var e=[],n=0,o=Object.keys(r);n<o.length;n++){var i=o[n];e[i]=t(r[i])}return e}(o))}function o(r,t){for(var e=0;e<r.childNodes.length;){var n=r.childNodes[e];if(1===n.nodeType&&c(n)===t)return n;e++}}function i(r,t){for(var e=[],n=0;n<r.childNodes.length;){var o=r.childNodes[n];1===o.nodeType&&c(o)===t&&e.push(o),n++}return e}function u(r,t,e){for(var n=0;n<r.childNodes.length;){var o=r.childNodes[n];t?1===o.nodeType&&c(o)===t&&e(o,n):e(o,n),n++}}var a=/.+\:/;function c(r){return r.tagName.replace(a,"")}function f(r){if(1!==r.nodeType)return r.textContent;for(var t="<"+c(r),e=0;e<r.attributes.length;)t+=" "+r.attributes[e].name+'="'+r.attributes[e].value+'"',e++;t+=">";for(var n=0;n<r.childNodes.length;)t+=f(r.childNodes[n]),n++;return t+="</"+c(r)+">"}function l(r){var t,e,n=r.documentElement;return t=function(r){var t=o(r,"t");if(t)return t.textContent;var e="";return u(r,"r",(function(r){e+=o(r,"t").textContent})),e},e=[],u(n,"si",(function(r,n){e.push(t(r,n))})),e}function s(r,t){var e=t.createDocument(r),n={},u=o(e.documentElement,"workbookPr");u&&"1"===u.getAttribute("date1904")&&(n.epoch1904=!0),n.sheets=[];return function(r){return i(o(r.documentElement,"sheets"),"sheet")}(e).forEach((function(r){r.getAttribute("name")&&n.sheets.push({id:r.getAttribute("sheetId"),name:r.getAttribute("name"),relationId:r.getAttribute("r:id")})})),n}function p(r,t){var e=t.createDocument(r),n={sheets:{},sharedStrings:void 0,styles:void 0};return function(r){return i(r.documentElement,"Relationship")}(e).forEach((function(r){var t=r.getAttribute("Target");switch(r.getAttribute("Type")){case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles":n.styles=y(t);break;case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings":n.sharedStrings=y(t);break;case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet":n.sheets[r.getAttribute("Id")]=y(t)}})),n}function y(r){return"/"===r[0]?r.slice(1):"xl/"+r}function m(r,t){var e=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(r,t).enumerable}))),e.push.apply(e,n)}return e}function b(r){for(var t=1;t<arguments.length;t++){var e=null!=arguments[t]?arguments[t]:{};t%2?m(Object(e),!0).forEach((function(t){d(r,t,e[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(e)):m(Object(e)).forEach((function(t){Object.defineProperty(r,t,Object.getOwnPropertyDescriptor(e,t))}))}return r}function d(r,t,e){return t in r?Object.defineProperty(r,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):r[t]=e,r}function v(r,t){if(!r)return{};var e,n,u=t.createDocument(r),a=(e=u,n=o(e.documentElement,"cellStyleXfs"),n?i(n,"xf"):[]).map(g),c=function(r){var t=o(r.documentElement,"numFmts");return t?i(t,"numFmt"):[]}(u).map(h).reduce((function(r,t){return r[t.id]=t,r}),[]);return function(r){var t=o(r.documentElement,"cellXfs");return t?i(t,"xf"):[]}(u).map((function(r){return r.hasAttribute("xfId")?b(b({},a[r.xfId]),g(r,c)):g(r,c)}))}function h(r){return{id:r.getAttribute("numFmtId"),template:r.getAttribute("formatCode")}}function g(r,t){var e={};if(r.hasAttribute("numFmtId")){var n=r.getAttribute("numFmtId");t[n]?e.numberFormat=t[n]:e.numberFormat={id:n}}return e}function w(r,t){t&&t.epoch1904&&(r+=1462);return new Date(Math.round(24*(r-25569)*36e5))}function O(r,t){var e="undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(e)return(e=e.call(r)).next.bind(e);if(Array.isArray(r)||(e=function(r,t){if(!r)return;if("string"==typeof r)return j(r,t);var e=Object.prototype.toString.call(r).slice(8,-1);"Object"===e&&r.constructor&&(e=r.constructor.name);if("Map"===e||"Set"===e)return Array.from(r);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return j(r,t)}(r))||t&&r&&"number"==typeof r.length){e&&(r=e);var n=0;return function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function j(r,t){(null==t||t>r.length)&&(t=r.length);for(var e=0,n=new Array(t);e<t;e++)n[e]=r[e];return n}function S(r,t,e){if(r){var n=t[r];if(!n)throw new Error("Cell style not found: ".concat(r));if(!n.numberFormat)return!1;if(A.indexOf(Number(n.numberFormat.id))>=0||e.dateFormat&&n.numberFormat.template===e.dateFormat||!1!==e.smartDateParser&&n.numberFormat.template&&function(r){for(var t,e=O((r=(r=(r=r.toLowerCase()).replace(E,"")).replace(P,"")).split(/\W+/));!(t=e()).done;){var n=t.value;if(I.indexOf(n)<0)return!1}return!0}(n.numberFormat.template))return!0}}var A=[14,15,16,17,18,19,20,21,22,27,30,36,45,46,47,50,57],E=/^\[\$-414\]/,P=/;@$/;var I=["ss","mm","h","hh","am","pm","d","dd","m","mm","mmm","mmmm","yy","yyyy","e"];function x(r,t,e){var n=e.getInlineStringValue,o=e.getInlineStringXml,i=e.getStyleId,u=e.styles,a=e.values,c=e.properties,f=e.options;switch(t||(t="n"),t){case"str":r=_(r,f);break;case"inlineStr":if(void 0===(r=n()))throw new Error('Unsupported "inline string" cell value structure: '.concat(o()));r=_(r,f);break;case"s":var l=Number(r);if(isNaN(l))throw new Error('Invalid "shared" string index: '.concat(r));if(l>=a.length)throw new Error('An out-of-bounds "shared" string index: '.concat(r));r=_(r=a[l],f);break;case"b":if("1"===r)r=!0;else{if("0"!==r)throw new Error('Unsupported "boolean" cell value: '.concat(r));r=!1}break;case"z":r=void 0;break;case"e":r=function(r){switch(r){case 0:return"#NULL!";case 7:return"#DIV/0!";case 15:return"#VALUE!";case 23:return"#REF!";case 29:return"#NAME?";case 36:return"#NUM!";case 42:return"#N/A";case 43:return"#GETTING_DATA";default:return"#ERROR_".concat(r)}}(r);break;case"d":if(void 0===r)break;var s=new Date(r);if(isNaN(s.valueOf()))throw new Error('Unsupported "date" cell value: '.concat(r));r=s;break;case"n":if(void 0===r)break;r=S(i(),u,f)?w(r=D(r),c):(f.parseNumber||D)(r);break;default:throw new TypeError("Cell type not supported: ".concat(t))}return void 0===r&&(r=null),r}function _(r,t){return!1!==t.trim&&(r=r.trim()),""===r&&(r=void 0),r}function D(r){var t=Number(r);if(isNaN(t))throw new Error('Invalid "numeric" cell value: '.concat(r));return t}var N=["","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];function k(r){for(var t=0,e=0;e<r.length;)t*=26,t+=N.indexOf(r[e]),e++;return t}function T(r){return r=r.split(/(\d+)/),[parseInt(r[1]),k(r[0].trim())]}function C(r,t,e,n,i,u,a){var l,s=T(r.getAttribute("r")),p=function(r,t){return o(t,"v")}(0,r),y=p&&p.textContent;return r.hasAttribute("t")&&(l=r.getAttribute("t")),{row:s[0],column:s[1],value:x(y,l,{getInlineStringValue:function(){return function(r,t){if(t.firstChild&&"is"===c(t.firstChild)&&t.firstChild.firstChild&&"t"===c(t.firstChild.firstChild))return t.firstChild.firstChild.textContent}(0,r)},getInlineStringXml:function(){return f(r)},getStyleId:function(){return r.getAttribute("s")},styles:i,values:n,properties:u,options:a})}}function F(r,t,e,n,i,a){var c=function(r){var t=o(r.documentElement,"sheetData"),e=[];return u(t,"row",(function(r){u(r,"c",(function(r){e.push(r)}))})),e}(r);return 0===c.length?[]:c.map((function(r){return C(r,0,0,e,n,i,a)}))}function M(r,t){return function(r){if(Array.isArray(r))return r}(r)||function(r,t){var e=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null==e)return;var n,o,i=[],u=!0,a=!1;try{for(e=e.call(r);!(u=(n=e.next()).done)&&(i.push(n.value),!t||i.length!==t);u=!0);}catch(r){a=!0,o=r}finally{try{u||null==e.return||e.return()}finally{if(a)throw o}}return i}(r,t)||function(r,t){if(!r)return;if("string"==typeof r)return U(r,t);var e=Object.prototype.toString.call(r).slice(8,-1);"Object"===e&&r.constructor&&(e=r.constructor.name);if("Map"===e||"Set"===e)return Array.from(r);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return U(r,t)}(r,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function U(r,t){(null==t||t>r.length)&&(t=r.length);for(var e=0,n=new Array(t);e<t;e++)n[e]=r[e];return n}function R(r){var t=function(r){var t=o(r.documentElement,"dimension");if(t)return t.getAttribute("ref")}(r);if(t)return 1===(t=t.split(":").map(T).map((function(r){var t=M(r,2);return{row:t[0],column:t[1]}}))).length&&(t=[t[0],t[0]]),t}function $(r,t){var e="undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(e)return(e=e.call(r)).next.bind(e);if(Array.isArray(r)||(e=function(r,t){if(!r)return;if("string"==typeof r)return z(r,t);var e=Object.prototype.toString.call(r).slice(8,-1);"Object"===e&&r.constructor&&(e=r.constructor.name);if("Map"===e||"Set"===e)return Array.from(r);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return z(r,t)}(r))||t&&r&&"number"==typeof r.length){e&&(r=e);var n=0;return function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function z(r,t){(null==t||t>r.length)&&(t=r.length);for(var e=0,n=new Array(t);e<t;e++)n[e]=r[e];return n}function B(r,t){var e="undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(e)return(e=e.call(r)).next.bind(e);if(Array.isArray(r)||(e=function(r,t){if(!r)return;if("string"==typeof r)return V(r,t);var e=Object.prototype.toString.call(r).slice(8,-1);"Object"===e&&r.constructor&&(e=r.constructor.name);if("Map"===e||"Set"===e)return Array.from(r);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return V(r,t)}(r))||t&&r&&"number"==typeof r.length){e&&(r=e);var n=0;return function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function V(r,t){(null==t||t>r.length)&&(t=r.length);for(var e=0,n=new Array(t);e<t;e++)n[e]=r[e];return n}function q(r,t){return function(r){if(Array.isArray(r))return r}(r)||function(r,t){var e=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null==e)return;var n,o,i=[],u=!0,a=!1;try{for(e=e.call(r);!(u=(n=e.next()).done)&&(i.push(n.value),!t||i.length!==t);u=!0);}catch(r){a=!0,o=r}finally{try{u||null==e.return||e.return()}finally{if(a)throw o}}return i}(r,t)||L(r,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function L(r,t){if(r){if("string"==typeof r)return X(r,t);var e=Object.prototype.toString.call(r).slice(8,-1);return"Object"===e&&r.constructor&&(e=r.constructor.name),"Map"===e||"Set"===e?Array.from(r):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?X(r,t):void 0}}function X(r,t){(null==t||t>r.length)&&(t=r.length);for(var e=0,n=new Array(t);e<t;e++)n[e]=r[e];return n}function Z(r,t){var e=r.dimensions,n=r.cells;if(0===n.length)return[];var o=q(e,2);o[0];for(var i=o[1],u=i.column,a=i.row,c=new Array(a),f=0;f<a;){c[f]=new Array(u);for(var l=0;l<u;)c[f][l]=null,l++;f++}for(var s,p=function(r,t){var e="undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(e)return(e=e.call(r)).next.bind(e);if(Array.isArray(r)||(e=L(r))||t&&r&&"number"==typeof r.length){e&&(r=e);var n=0;return function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(n);!(s=p()).done;){var y=s.value,m=y.row-1,b=y.column-1;b<u&&m<a&&(c[m][b]=y.value)}var d=t.rowMap;if(d)for(var v=0;v<c.length;)d[v]=v,v++;return c=function(r){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},e=t.rowMap,n=t.accessor,o=void 0===n?function(r){return r}:n,i=t.onlyTrimAtTheEnd,u=r.length-1;u>=0;){for(var a,c=!0,f=$(r[u]);!(a=f()).done;)if(null!==o(a.value)){c=!1;break}if(c)r.splice(u,1),e&&e.splice(u,1);else if(i)break;u--}return r}(function(r){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},e=t.accessor,n=void 0===e?function(r){return r}:e,o=t.onlyTrimAtTheEnd,i=r[0].length-1;i>=0;){for(var u,a=!0,c=B(r);!(u=c()).done;)if(null!==n(u.value[i])){a=!1;break}if(a)for(var f=0;f<r.length;)r[f].splice(i,1),f++;else if(o)break;i--}return r}(c,{onlyTrimAtTheEnd:!0}),{onlyTrimAtTheEnd:!0,rowMap:d}),t.transformData&&(c=t.transformData(c)),c}function G(r,t){var e="undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(e)return(e=e.call(r)).next.bind(e);if(Array.isArray(r)||(e=function(r,t){if(!r)return;if("string"==typeof r)return W(r,t);var e=Object.prototype.toString.call(r).slice(8,-1);"Object"===e&&r.constructor&&(e=r.constructor.name);if("Map"===e||"Set"===e)return Array.from(r);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return W(r,t)}(r))||t&&r&&"number"==typeof r.length){e&&(r=e);var n=0;return function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function W(r,t){(null==t||t>r.length)&&(t=r.length);for(var e=0,n=new Array(t);e<t;e++)n[e]=r[e];return n}function H(r,t){var e=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(r,t).enumerable}))),e.push.apply(e,n)}return e}function J(r,t,e){return t in r?Object.defineProperty(r,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):r[t]=e,r}function K(r,t){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};e.sheet||(e=function(r){for(var t=1;t<arguments.length;t++){var e=null!=arguments[t]?arguments[t]:{};t%2?H(Object(e),!0).forEach((function(t){J(r,t,e[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(e)):H(Object(e)).forEach((function(t){Object.defineProperty(r,t,Object.getOwnPropertyDescriptor(e,t))}))}return r}({sheet:1},e));var n=function(t){if(!r[t])throw new Error('"'.concat(t,'" file not found inside the *.xlsx file zip archive'));return r[t]},o=p(n("xl/_rels/workbook.xml.rels"),t),i=o.sharedStrings?function(r,t){return r?l(t.createDocument(r)):[]}(n(o.sharedStrings),t):[],u=o.styles?v(n(o.styles),t):{},a=s(n("xl/workbook.xml"),t);if(e.getSheets)return a.sheets.map((function(r){return{name:r.name}}));var c=function(r,t){if("number"==typeof r){var e=t[r-1];return e&&e.relationId}for(var n,o=G(t);!(n=o()).done;){var i=n.value;if(i.name===r)return i.relationId}}(e.sheet,a.sheets);if(!c||!o.sheets[c])throw function(r,t){var e=t&&t.map((function(r,t){return'"'.concat(r.name,'" (#').concat(t+1,")")})).join(", ");return new Error("Sheet ".concat("number"==typeof r?"#"+r:'"'+r+'"'," not found in the *.xlsx file.").concat(t?" Available sheets: "+e+".":""))}(e.sheet,a.sheets);var f=function(r,t,e,n,o,i){var u=t.createDocument(r),a=F(u,0,e,n,o,i),c=R(u)||function(r){var t=function(r,t){return r-t},e=r.map((function(r){return r.row})).sort(t),n=r.map((function(r){return r.column})).sort(t),o=e[0],i=e[e.length-1];return[{row:o,column:n[0]},{row:i,column:n[n.length-1]}]}(a);return{cells:a,dimensions:c}}(n(o.sheets[c]),t,i,u,a,e),y=Z(f,e);return e.properties?{data:y,properties:a}:y}function Q(r){return Q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(r){return typeof r}:function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Q(r)}function Y(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function rr(r){var t=nr();return function(){var e,n=ir(r);if(t){var o=ir(this).constructor;e=Reflect.construct(n,arguments,o)}else e=n.apply(this,arguments);return function(r,t){if(t&&("object"===Q(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(r){if(void 0===r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}(r)}(this,e)}}function tr(r){var t="function"==typeof Map?new Map:void 0;return tr=function(r){if(null===r||(e=r,-1===Function.toString.call(e).indexOf("[native code]")))return r;var e;if("function"!=typeof r)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(r))return t.get(r);t.set(r,n)}function n(){return er(r,arguments,ir(this).constructor)}return n.prototype=Object.create(r.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),or(n,r)},tr(r)}function er(r,t,e){return er=nr()?Reflect.construct:function(r,t,e){var n=[null];n.push.apply(n,t);var o=new(Function.bind.apply(r,n));return e&&or(o,e.prototype),o},er.apply(null,arguments)}function nr(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(r){return!1}}function or(r,t){return or=Object.setPrototypeOf||function(r,t){return r.__proto__=t,r},or(r,t)}function ir(r){return ir=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},ir(r)}var ur=function(r){!function(r,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&or(r,t)}(i,tr(Error));var t,e,n,o=rr(i);function i(r){var t;return function(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,"invalid")).reason=r,t}return t=i,e&&Y(t.prototype,e),n&&Y(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}();function ar(r){if("string"==typeof r){var t=r;if(r=Number(r),String(r)!==t)throw new ur("not_a_number")}if("number"!=typeof r)throw new ur("not_a_number");if(isNaN(r))throw new ur("invalid_number");if(!isFinite(r))throw new ur("out_of_bounds");return r}function cr(r){if("string"==typeof r)return r;if("number"==typeof r){if(isNaN(r))throw new ur("invalid_number");if(!isFinite(r))throw new ur("out_of_bounds");return String(r)}throw new ur("not_a_string")}function fr(r){if("boolean"==typeof r)return r;throw new ur("not_a_boolean")}function lr(r,t){return function(r){if(Array.isArray(r))return r}(r)||function(r,t){var e=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null==e)return;var n,o,i=[],u=!0,a=!1;try{for(e=e.call(r);!(u=(n=e.next()).done)&&(i.push(n.value),!t||i.length!==t);u=!0);}catch(r){a=!0,o=r}finally{try{u||null==e.return||e.return()}finally{if(a)throw o}}return i}(r,t)||pr(r,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function sr(r){return sr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(r){return typeof r}:function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},sr(r)}function pr(r,t){if(r){if("string"==typeof r)return yr(r,t);var e=Object.prototype.toString.call(r).slice(8,-1);return"Object"===e&&r.constructor&&(e=r.constructor.name),"Map"===e||"Set"===e?Array.from(r):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?yr(r,t):void 0}}function yr(r,t){(null==t||t>r.length)&&(t=r.length);for(var e=0,n=new Array(t);e<t;e++)n[e]=r[e];return n}function mr(r,t){var e=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(r,t).enumerable}))),e.push.apply(e,n)}return e}function br(r){for(var t=1;t<arguments.length;t++){var e=null!=arguments[t]?arguments[t]:{};t%2?mr(Object(e),!0).forEach((function(t){dr(r,t,e[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(e)):mr(Object(e)).forEach((function(t){Object.defineProperty(r,t,Object.getOwnPropertyDescriptor(e,t))}))}return r}function dr(r,t,e){return t in r?Object.defineProperty(r,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):r[t]=e,r}var vr={isColumnOriented:!1};function hr(r,t,e){var n=e=e?br(br({},vr),e):vr,o=n.isColumnOriented,i=n.rowMap,u=n.ignoreEmptyRows;!function(r){for(var t=0,e=Object.keys(r);t<e.length;t++){var n=e[t];if(!r[n].prop)throw new Error('"prop" not defined for schema entry "'.concat(n,'".'))}}(t),o&&(r=Sr(r));for(var a=r[0],c=[],f=[],l=1;l<r.length;l++){var s=gr(t,r[l],l,a,f,e);null===s&&!1!==u||c.push(s)}if(i)for(var p,y=function(r,t){var e="undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(e)return(e=e.call(r)).next.bind(e);if(Array.isArray(r)||(e=pr(r))||t&&r&&"number"==typeof r.length){e&&(r=e);var n=0;return function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(f);!(p=y()).done;){var m=p.value;m.row=i[m.row-1]+1}return{rows:c,errors:f}}function gr(r,t,e,n,o,i){for(var u={},a=!0,c=function(t){var n=t.column,o=t.value,i=t.error,u=t.reason,a={error:i,row:e+1,column:n,value:o};return u&&(a.reason=u),r[n].type&&(a.type=r[n].type),a},f=[],l=function(){var l=p[s],y=r[l],m="object"===sr(y.type)&&!Array.isArray(y.type),b=t[n.indexOf(l)];void 0===b&&(b=null);var d=void 0,v=void 0,h=void 0;if(m)d=gr(y.type,t,e,n,o,i);else if(null===b)d=null;else if(Array.isArray(y.type)){var g=!1,w=function(r){var t=[],e=0;for(;e<r.length;){var n=lr(jr(r,",",e),2),o=n[0];e+=n[1]+1,t.push(o.trim())}return t}(b).map((function(r){var t=wr(r,y,i);return t.error&&(d=r,v=t.error,h=t.reason),null!==t.value&&(g=!0),t.value}));v||(d=g?w:null)}else{var O=wr(b,y,i);v=O.error,h=O.reason,d=v?b:O.value}v||null!==d||("function"==typeof y.required?f.push({column:l}):!0===y.required&&(v="required")),v?o.push(c({column:l,value:d,error:v,reason:h})):(a&&null!==d&&(a=!1),(null!==d||i.includeNullValues)&&(u[y.prop]=d))},s=0,p=Object.keys(r);s<p.length;s++)l();if(a)return null;for(var y=0,m=f;y<m.length;y++){var b=m[y].column;r[b].required(u)&&o.push(c({column:b,value:null,error:"required"}))}return u}function wr(r,t,e){if(null===r)return{value:null};var n;if(n=t.parse?Or(r,t.parse):t.type?function(r,t,e){switch(t){case String:return Or(r,cr);case Number:return Or(r,ar);case Date:return Or(r,(function(r){return function(r,t){var e=t.properties;if(r instanceof Date){if(isNaN(r.valueOf()))throw new ur("out_of_bounds");return r}if("number"==typeof r){if(isNaN(r))throw new ur("invalid_number");if(!isFinite(r))throw new ur("out_of_bounds");var n=w(r,e);if(isNaN(n.valueOf()))throw new ur("out_of_bounds");return n}throw new ur("not_a_date")}(r,{properties:e.properties})}));case Boolean:return Or(r,fr);default:if("function"==typeof t)return Or(r,t);throw new Error("Unsupported schema type: ".concat(t&&t.name||t))}}(r,Array.isArray(t.type)?t.type[0]:t.type,e):{value:r},n.error)return n;if(null!==n.value){if(t.oneOf&&t.oneOf.indexOf(n.value)<0)return{error:"invalid",reason:"unknown"};if(t.validate)try{t.validate(n.value)}catch(r){return{error:r.message}}}return n}function Or(r,t){try{return void 0===(r=t(r))?{value:null}:{value:r}}catch(r){var e={error:r.message};return r.reason&&(e.reason=r.reason),e}}function jr(r,t,e){for(var n=0,o="";e+n<r.length;){var i=r[e+n];if(i===t)return[o,n];if('"'===i){var u=jr(r,'"',e+n+1);o+=u[0],n+=1+u[1]+1}else o+=i,n++}return[o,n]}var Sr=function(r){return r[0].map((function(t,e){return r.map((function(r){return r[e]}))}))};function Ar(r){return Ar="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(r){return typeof r}:function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Ar(r)}function Er(r){for(var t={},e=0,n=Object.keys(r);e<n.length;e++){var o=n[e],i=r[o],u=void 0;"object"===Ar(i)&&(i=Object.keys(r[o])[0],u=Er(r[o][i])),t[o]={prop:i},u&&(t[o].type=u)}return t}var Pr=["schema","map"];function Ir(r,t){var e=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(r,t).enumerable}))),e.push.apply(e,n)}return e}function xr(r){for(var t=1;t<arguments.length;t++){var e=null!=arguments[t]?arguments[t]:{};t%2?Ir(Object(e),!0).forEach((function(t){_r(r,t,e[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(e)):Ir(Object(e)).forEach((function(t){Object.defineProperty(r,t,Object.getOwnPropertyDescriptor(e,t))}))}return r}function _r(r,t,e){return t in r?Object.defineProperty(r,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):r[t]=e,r}function Dr(r,t){if(null==r)return{};var e,n,o=function(r,t){if(null==r)return{};var e,n,o={},i=Object.keys(r);for(n=0;n<i.length;n++)e=i[n],t.indexOf(e)>=0||(o[e]=r[e]);return o}(r,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);for(n=0;n<i.length;n++)e=i[n],t.indexOf(e)>=0||Object.prototype.propertyIsEnumerable.call(r,e)&&(o[e]=r[e])}return o}function Nr(r,t,e){var n=e.schema,o=e.map,i=Dr(e,Pr);!n&&o&&(n=Er(o));var u=K(r,t,xr(xr({},i),{},{properties:n||i.properties}));return n?hr(u.data,n,xr(xr({},i),{},{properties:u.properties})):u}function kr(r){var t,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(t=r,t instanceof File||t instanceof Blob?t.arrayBuffer().then(n):n(t)).then((function(r){return Nr(r,e,o)}))}function Tr(r){return kr(r,{getSheets:!0}).then((function(r){return r.map((function(r){return r.name}))}))}function Cr(r){if(r=ar(r),(0|(t=r))!==t)throw new ur("not_an_integer");var t;return r}function Fr(r){if("string"==typeof r){if(function(r){return Mr.test(r)}(r))return r;throw new ur("not_an_email")}throw new ur("not_a_string")}var Mr=/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i;function Ur(r){if("string"==typeof r){if(function(r){return Rr.test(r)}(r))return r;throw new ur("not_a_url")}throw new ur("not_a_string")}var Rr=/^(?:(?:(?:https?|ftp):)?\/\/)(?:(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z0-9\u00a1-\uffff][a-z0-9\u00a1-\uffff_-]{0,62})?[a-z0-9\u00a1-\uffff]\.)*(?:[a-z\u00a1-\uffff]{2,}))(?::\d{2,5})?(?:[/?#]\S*)?$/i;export{Fr as Email,Cr as Integer,Ur as URL,kr as default,w as parseExcelDate,Tr as readSheetNames};